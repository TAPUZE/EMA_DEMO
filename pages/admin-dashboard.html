<!-- ==================== ADMIN DASHBOARD ==================== -->

<div class="p-6">
    <div class="mb-6">
        <h1 class="text-3xl font-bold text-gray-800">Admin Dashboard</h1>
        <p class="text-gray-600">System Overview & Management</p>
    </div>

    <!-- Quick Stats -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
        <!-- Total Patients -->
        <div class="glass p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm text-gray-600 mb-1">Total Patients</p>
                    <p class="text-3xl font-bold text-sky-600" id="admin-total-patients">0</p>
                </div>
                <div class="w-14 h-14 bg-sky-100 rounded-full flex items-center justify-center">
                    <i class="ph ph-users-three text-sky-600 text-2xl"></i>
                </div>
            </div>
        </div>

        <!-- Active Providers -->
        <div class="glass p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm text-gray-600 mb-1">Active Providers</p>
                    <p class="text-3xl font-bold text-green-600" id="admin-providers">0</p>
                </div>
                <div class="w-14 h-14 bg-green-100 rounded-full flex items-center justify-center">
                    <i class="ph ph-user-circle-gear text-green-600 text-2xl"></i>
                </div>
            </div>
        </div>

        <!-- Today's Appointments -->
        <div class="glass p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm text-gray-600 mb-1">Today's Appointments</p>
                    <p class="text-3xl font-bold text-purple-600" id="admin-appointments">0</p>
                </div>
                <div class="w-14 h-14 bg-purple-100 rounded-full flex items-center justify-center">
                    <i class="ph ph-calendar-check text-purple-600 text-2xl"></i>
                </div>
            </div>
        </div>

        <!-- System Alerts -->
        <div class="glass p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm text-gray-600 mb-1">System Alerts</p>
                    <p class="text-3xl font-bold text-red-600" id="admin-alerts">0</p>
                </div>
                <div class="w-14 h-14 bg-red-100 rounded-full flex items-center justify-center">
                    <i class="ph ph-warning-circle text-red-600 text-2xl"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- User Management -->
        <div class="glass p-6">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold text-gray-800">
                    <i class="ph ph-users-three text-sky-600 mr-2"></i>
                    User Management
                </h2>
                <button class="btn-primary btn-sm" onclick="window.showAddUserModal()">
                    <i class="ph ph-plus mr-1"></i>
                    Add User
                </button>
            </div>
            <div id="admin-user-list" class="space-y-2"></div>
        </div>

        <!-- Recent Activity -->
        <div class="glass p-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">
                <i class="ph ph-clock-counter-clockwise text-purple-600 mr-2"></i>
                Recent Activity
            </h2>
            <div id="admin-recent-activity" class="space-y-2"></div>
        </div>

        <!-- Clinic-Wide Metrics -->
        <div class="glass p-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">
                <i class="ph ph-chart-line text-green-600 mr-2"></i>
                Clinic Performance
            </h2>
            <div class="space-y-4">
                <div>
                    <div class="flex justify-between text-sm mb-1">
                        <span class="text-gray-600">Patient Satisfaction</span>
                        <span class="font-semibold">4.8/5.0</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div class="bg-green-500 h-2 rounded-full" style="width: 96%"></div>
                    </div>
                </div>
                <div>
                    <div class="flex justify-between text-sm mb-1">
                        <span class="text-gray-600">Appointment Fill Rate</span>
                        <span class="font-semibold">87%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div class="bg-sky-500 h-2 rounded-full" style="width: 87%"></div>
                    </div>
                </div>
                <div>
                    <div class="flex justify-between text-sm mb-1">
                        <span class="text-gray-600">AWV Completion Rate</span>
                        <span class="font-semibold">72%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div class="bg-purple-500 h-2 rounded-full" style="width: 72%"></div>
                    </div>
                </div>
                <div>
                    <div class="flex justify-between text-sm mb-1">
                        <span class="text-gray-600">Documentation Compliance</span>
                        <span class="font-semibold">94%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div class="bg-green-500 h-2 rounded-full" style="width: 94%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- System Health -->
        <div class="glass p-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">
                <i class="ph ph-shield-check text-green-600 mr-2"></i>
                System Health
            </h2>
            <div class="space-y-3">
                <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                    <div class="flex items-center gap-3">
                        <i class="ph ph-check-circle text-green-600 text-xl"></i>
                        <span class="font-medium">Database Status</span>
                    </div>
                    <span class="text-green-600 font-semibold">Online</span>
                </div>
                <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                    <div class="flex items-center gap-3">
                        <i class="ph ph-check-circle text-green-600 text-xl"></i>
                        <span class="font-medium">API Services</span>
                    </div>
                    <span class="text-green-600 font-semibold">Operational</span>
                </div>
                <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                    <div class="flex items-center gap-3">
                        <i class="ph ph-check-circle text-green-600 text-xl"></i>
                        <span class="font-medium">Backup Status</span>
                    </div>
                    <span class="text-green-600 font-semibold">Current</span>
                </div>
                <div class="flex items-center justify-between p-3 bg-yellow-50 rounded-lg">
                    <div class="flex items-center gap-3">
                        <i class="ph ph-warning text-yellow-600 text-xl"></i>
                        <span class="font-medium">Storage Usage</span>
                    </div>
                    <span class="text-yellow-600 font-semibold">78%</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add User Modal -->
<div id="add-user-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
    <div class="bg-white rounded-lg w-full max-w-md p-6">
        <div class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-bold text-gray-800">Add New User</h2>
            <button onclick="document.getElementById('add-user-modal').classList.add('hidden')" class="text-gray-500 hover:text-gray-700">
                <i class="ph ph-x text-2xl"></i>
            </button>
        </div>
        <form id="add-user-form" class="space-y-4">
            <div>
                <label class="block text-sm font-medium mb-1">Full Name</label>
                <input type="text" class="w-full px-3 py-2 border rounded-lg" required>
            </div>
            <div>
                <label class="block text-sm font-medium mb-1">Email</label>
                <input type="email" class="w-full px-3 py-2 border rounded-lg" required>
            </div>
            <div>
                <label class="block text-sm font-medium mb-1">Role</label>
                <select class="w-full px-3 py-2 border rounded-lg" required>
                    <option value="provider">Provider</option>
                    <option value="nurse">Nurse</option>
                    <option value="admin">Admin</option>
                    <option value="receptionist">Receptionist</option>
                </select>
            </div>
            <div class="flex gap-2">
                <button type="submit" class="btn-primary flex-1">Add User</button>
                <button type="button" onclick="document.getElementById('add-user-modal').classList.add('hidden')" class="btn-secondary flex-1">Cancel</button>
            </div>
        </form>
    </div>
</div>

<script type="module">
    import { showToast } from '../js/ui-components.js';

    window.initAdminDashboard = function() {
        console.log('ðŸ‘” Admin Dashboard loaded');
        loadAdminStats();
        loadUserList();
        loadRecentActivity();
    };

    function loadAdminStats() {
        // Load statistics
        document.getElementById('admin-total-patients').textContent = '3,247';
        document.getElementById('admin-providers').textContent = '15';
        document.getElementById('admin-appointments').textContent = '37';
        document.getElementById('admin-alerts').textContent = '5';
    }

    function loadUserList() {
        const users = [
            { name: 'Dr. Ange Pompee', role: 'Provider', status: 'active', lastLogin: '2 hours ago' },
            { name: 'Dr. Sarah Chen', role: 'Provider', status: 'active', lastLogin: '5 hours ago' },
            { name: 'Dr. Michael Torres', role: 'Provider', status: 'active', lastLogin: '1 day ago' },
            { name: 'Nurse Jennifer Smith', role: 'Nurse', status: 'active', lastLogin: '30 min ago' },
            { name: 'Admin User', role: 'Admin', status: 'active', lastLogin: 'Now' }
        ];

        const container = document.getElementById('admin-user-list');
        container.innerHTML = users.map(user => `
            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-sky-500 text-white rounded-full flex items-center justify-center">
                        <i class="ph ph-user"></i>
                    </div>
                    <div>
                        <div class="font-medium text-gray-800">${user.name}</div>
                        <div class="text-xs text-gray-600">${user.role} â€¢ Last seen ${user.lastLogin}</div>
                    </div>
                </div>
                <button class="text-gray-400 hover:text-gray-600">
                    <i class="ph ph-dots-three-vertical"></i>
                </button>
            </div>
        `).join('');
    }

    function loadRecentActivity() {
        const activities = [
            { user: 'Dr. Pompee', action: 'Completed visit note', patient: 'John Smith', time: '5 min ago', icon: 'ph-note-pencil', color: 'sky' },
            { user: 'Nurse Smith', action: 'Checked in patient', patient: 'Jane Doe', time: '12 min ago', icon: 'ph-check-circle', color: 'green' },
            { user: 'Dr. Chen', action: 'Ordered lab tests', patient: 'Alice Johnson', time: '25 min ago', icon: 'ph-flask', color: 'purple' },
            { user: 'Dr. Torres', action: 'Prescribed medication', patient: 'John Smith', time: '1 hour ago', icon: 'ph-pill', color: 'orange' },
            { user: 'Admin', action: 'Updated system settings', patient: null, time: '2 hours ago', icon: 'ph-gear', color: 'gray' }
        ];

        const container = document.getElementById('admin-recent-activity');
        container.innerHTML = activities.map(activity => `
            <div class="flex items-start gap-3 p-3 bg-gray-50 rounded-lg">
                <div class="w-8 h-8 bg-${activity.color}-100 text-${activity.color}-600 rounded-full flex items-center justify-center flex-shrink-0">
                    <i class="${activity.icon} text-sm"></i>
                </div>
                <div class="flex-1 min-w-0">
                    <div class="text-sm">
                        <span class="font-medium text-gray-800">${activity.user}</span>
                        <span class="text-gray-600"> ${activity.action}</span>
                        ${activity.patient ? `<span class="text-gray-600"> for <span class="font-medium">${activity.patient}</span></span>` : ''}
                    </div>
                    <div class="text-xs text-gray-500">${activity.time}</div>
                </div>
            </div>
        `).join('');
    }

    window.showAddUserModal = function() {
        document.getElementById('add-user-modal').classList.remove('hidden');
    };

    document.getElementById('add-user-form')?.addEventListener('submit', (e) => {
        e.preventDefault();
        showToast('User added successfully!', 'success');
        document.getElementById('add-user-modal').classList.add('hidden');
        loadUserList();
    });

    // Auto-initialize if loaded
    if (document.readyState === 'complete') {
        window.initAdminDashboard();
    }
</script>
